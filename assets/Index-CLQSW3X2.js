import{p as q,r,A as L,j as e}from"./index-Baw52cgS.js";import{s as b}from"./MoradorService-Ddrmdc0G.js";import{T as s}from"./TipoMoradorEnum-PsNxfakq.js";import{B as z,A as R}from"./BlocoService-DNm1RMcC.js";import{D as V}from"./DeleteModal-ChgR_eH1.js";const P=()=>{const m=q();async function h(){try{const o=await b.listarMoradoresComFiltro({nome:l,bloco:n,apartamento:c,tipoMorador:i});A(o)}catch(o){console.error("Erro ao buscar moradores:",o)}}const[N,A]=r.useState([]),[l,C]=r.useState(""),[n,S]=r.useState(""),[c,g]=r.useState(0),[i,B]=r.useState(0),[u,y]=r.useState([]),[x,E]=r.useState([]),[T,j]=r.useState(!1),[p,f]=r.useState(null),v=r.useContext(L);r.useEffect(()=>{async function o(){const t=await z.listarBloco(),a=await R.listarApartamento();y(t),E(a)}o(),h()},[l,n,c,i]);const D=()=>{m("Cadastro")},F=o=>{m(`Cadastro/${o}`)},w=o=>{for(const t in s)if(s[t].value===o)return s[t].label;return""};async function I(o){try{await b.excluirMorador(o),v.addAlert("Morador excluído com sucesso","success"),await h()}catch(t){v.addAlert("Erro ao excluir morador","error"),console.error("Erro ao excluir morador:",t)}}const k=o=>{f(o),j(!0)},M=()=>{j(!1),f(null)},O=()=>{p&&(I(p),M())};return e.jsxs("div",{children:[e.jsx("h1",{children:"Lista de Moradores"}),e.jsx("div",{children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-4",children:[e.jsx("label",{className:"form-label",children:"Nome do Morador"}),e.jsx("input",{type:"text",placeholder:"Nome do Morador",className:"form-control",value:l,onChange:o=>C(o.target.value)})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("label",{className:"form-label",children:"Tipo de Morador"}),e.jsxs("select",{value:i,className:"form-control",onChange:o=>B(o.target.value),children:[e.jsx("option",{value:"",children:"Selecione"}),Object.values(s).map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))]})]}),e.jsxs("div",{className:"col-2",children:[e.jsx("label",{htmlFor:"filtroBloco",required:!0,className:"form-label",children:"Bloco"}),e.jsxs("select",{className:"form-select",id:"filtroBloco",value:n,onChange:o=>S(parseInt(o.target.value)),children:[e.jsx("option",{value:0,children:"Selecione"}),u.map(o=>e.jsx("option",{value:o.id,children:o.nome},o.id))]})]}),e.jsxs("div",{className:"col-2",children:[e.jsx("label",{htmlFor:"filtroApartamento",required:!0,className:"form-label",children:"Apartamento"}),e.jsxs("select",{className:"form-select",id:"filtroApartamento",value:c,onChange:o=>g(parseInt(o.target.value)),children:[e.jsx("option",{value:0,children:"Selecione"}),x.map(o=>e.jsx("option",{value:o.id,children:o.nome},o.id))]})]})]})}),e.jsx("button",{onClick:D,className:"btn btn-primary mt-3 mb-3",children:"Novo Morador"}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Código"}),e.jsx("th",{children:"Nome"}),e.jsx("th",{children:"Telefone"}),e.jsx("th",{children:"Tipo de Morador"}),e.jsx("th",{children:"Bloco"}),e.jsx("th",{children:"Apartamento"}),e.jsx("th",{children:"Alterar"}),e.jsx("th",{children:"Excluir"})]})}),e.jsx("tbody",{children:N.map(o=>{const t=u.find(d=>d.id===o.idBloco),a=x.find(d=>d.id===o.idApartamento);return e.jsxs("tr",{children:[e.jsx("td",{children:o.id}),e.jsx("td",{children:o.nome}),e.jsx("td",{children:o.telefone}),e.jsx("td",{children:w(o.tipoMorador)}),e.jsx("td",{children:t?t.nome:"Carregando..."}),e.jsx("td",{children:a?a.nome:"Carregando..."}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-primary",onClick:()=>F(o.id),children:"Alterar"})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-primary",onClick:()=>k(o.id),children:"Excluir"})})]},o.id)})})]}),e.jsx(V,{isOpen:T,onClose:M,onConfirm:O,mensagem:"Você tem certeza que deseja excluir este Morador?"})]})};export{P as default};
