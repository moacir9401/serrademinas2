import{q as N,r as t,A as V,j as a}from"./index-DOoR1ef2.js";import"./InputMask-BJgC5vPc.js";import{s as M}from"./MoradorService-B-AGjCYz.js";import{V as h,T as g}from"./TipoVeiculoEnum-BY2qjHpd.js";class S{constructor(n="",d=null,e="",r="",s="",m="",u=null){this.Id=n,this.tipoVeiculo=d,this.modelo=e,this.marca=r,this.placa=s,this.observacao=m,this.idMorador=u}}const E=()=>{const{veiculoId:c,moradorId:n}=N(),d=t.useContext(V),[e,r]=t.useState(new S),[s,m]=t.useState({});t.useState(!1);const[u,p]=t.useState([]);t.useEffect(()=>{async function o(){const l=await M.listarMoradores();p(l)}if(o(),c){async function l(){try{const i=await h.lerVeiculo(c);r(i)}catch(i){console.error("Erro ao buscar morador:",i)}}l()}n&&r({...r,idMorador:n})},[c]);const x=async o=>{o.preventDefault();const l={Id:e.id,tipoVeiculo:e.tipoVeiculo,modelo:e.modelo,marca:e.marca,placa:e.placa,idMorador:e.idMorador,observacao:e.observacao};m({});const i=b(l);if(Object.keys(i).length>0){m(i);return}try{if(c){const v=await h.atualizarVeiculo(c,l);d.addAlert("Ação Realizada com sucesso","success")}else{const v=await h.criarVeiculo(l);d.addAlert("Ação Realizada com sucesso","success"),f()}}catch(v){console.error("Erro ao criar morador:",v)}},b=o=>{const l={};return o.tipoVeiculo===null&&(l.tipoVeiculo='O campo "Tipo veiculo" é obrigatório.'),o.idMorador===null&&(l.morador='O campo "Morador" é obrigatório.'),l},f=()=>{r(morador)},j=o=>Object.keys(o).map(l=>a.jsx("option",{value:o[l].value,children:o[l].label},o[l].value));return a.jsxs("div",{className:"container",children:[a.jsx("h2",{children:"Criar Veiculo"}),a.jsxs("form",{onSubmit:x,children:[a.jsxs("div",{className:"col-2",children:[a.jsx("label",{className:"form-label",children:"id"}),a.jsx("span",{id:"id",className:"form-control",children:e.id})]}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-3",children:[a.jsx("label",{htmlFor:"nome",className:"form-label",children:"Tipo Veiculo"}),a.jsxs("select",{id:"tipoVeiculo",className:`form-select ${s.tipoVeiculo?"is-invalid":""}`,value:e.tipoVeiculo,onChange:o=>r({...e,tipoVeiculo:parseInt(o.target.value)}),children:[a.jsx("option",{value:null,children:"Selecione"}),j(g)]}),s.tipoVeiculo&&a.jsx("div",{className:"invalid-feedback",children:s.tipoVeiculo})]}),a.jsxs("div",{className:"col-3",children:[a.jsx("label",{htmlFor:"modelo",className:"form-label",children:"Modelo"}),a.jsx("input",{id:"modelo",type:"text",className:`form-control ${s.modelo?"is-invalid":""}`,value:e.modelo,onChange:o=>r({...e,modelo:o.target.value})})]}),a.jsxs("div",{className:"col-3",children:[a.jsx("label",{htmlFor:"marca",className:"form-label",children:"Marca"}),a.jsx("input",{id:"marca",type:"text",className:`form-control ${s.marca?"is-invalid":""}`,value:e.marca,onChange:o=>r({...e,marca:o.target.value})})]}),a.jsxs("div",{className:"col-3",children:[a.jsx("label",{htmlFor:"placa",className:"form-label",children:"Placa"}),a.jsx("input",{id:"placa",type:"text",className:"form-control",value:e.placa,onChange:o=>r({...e,placa:o.target.value})})]})]}),a.jsx("div",{className:"row",children:a.jsxs("div",{className:"col-4",children:[a.jsx("label",{htmlFor:"Morador",className:"form-label",children:"Morador "}),a.jsxs("select",{id:"Morador",type:"text",disabled:n!==void 0,className:`form-control ${s.morador?"is-invalid":""}`,value:e.idMorador,onChange:o=>r({...e,idMorador:parseInt(o.target.value)}),children:[a.jsx("option",{value:null,children:"Selecione"}),u.map(o=>a.jsx("option",{value:o.id,children:o.nome},o.id))]})]})}),a.jsx("div",{className:"row",children:a.jsxs("div",{className:"col-12",children:[a.jsx("label",{htmlFor:"observacao",className:"form-label",children:"Observação"}),a.jsx("input",{id:"observacao",type:"text",className:`form-control ${s.observacao?"is-invalid":""}`,value:e.observacao,onChange:o=>r({...e,observacao:o.target.value})})]})}),a.jsx("button",{type:"submit",className:"btn btn-primary mt-3",children:"Salvar"})]})]})};export{E as default};
