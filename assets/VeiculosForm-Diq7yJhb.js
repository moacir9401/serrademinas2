import{v as V,r as t,A as M,j as a}from"./index-LZNP7tki.js";import{p as g}from"./InputMask-CK0AgtKw.js";import{s as S}from"./MoradorService-BzWkpyU9.js";import{T as p,V as h}from"./TipoVeiculoEnum-fuqTUdA_.js";class y{constructor(n="",d=p,o="",l="",r="",m="",u=0){this.Id=n,this.TipoVeiculo=d,this.Modelo=o,this.Marca=l,this.Placa=r,this.Observacao=m,this.IdMorador=u}}const A=()=>{const{veiculoId:c,moradorId:n}=V(),d=t.useContext(M),[o,l]=t.useState(new y),[r,m]=t.useState({});t.useState(!1);const[u,x]=t.useState([]);t.useEffect(()=>{async function e(){const s=await S.listarMoradores();x(s)}if(e(),c){async function s(){try{const i=await h.lerVeiculo(c);l(i)}catch(i){console.error("Erro ao buscar morador:",i)}}s()}n&&l({...l,idMorador:n})},[c]);const f=async e=>{e.preventDefault();const s={Id:o.id,tipoVeiculo:o.tipoVeiculo,Modelo:o.modelo,Marca:o.marca,Placa:o.placa,idMorador:o.idMorador,Observacao:o.observacao};m({});const i=j(s);if(Object.keys(i).length>0){m(i);return}try{if(c){const v=await h.atualizarVeiculo(c,s);d.addAlert("A��o Realizada com sucesso","success")}else{const v=await h.criarVeiculo(s);d.addAlert("A��o Realizada com sucesso","success"),b()}}catch(v){console.error("Erro ao criar morador:",v)}},j=e=>{const s={};return e.tipoVeiculo===0&&(s.tipoVeiculo='O campo "Tipo veiculo" � obrigat�rio.'),s},b=()=>{l(morador)},N=e=>Object.keys(e).map(s=>a.jsx("option",{value:e[s].value,children:e[s].label},e[s].value));return a.jsxs("div",{className:"container",children:[a.jsx("h2",{children:"Criar Veiculo"}),a.jsxs("form",{onSubmit:f,children:[a.jsxs("div",{className:"col-2",children:[a.jsx("label",{className:"form-label",children:"id"}),a.jsx("span",{id:"id",className:"form-control",children:o.id})]}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-3",children:[a.jsx("label",{htmlFor:"nome",className:"form-label",children:"Tipo Veiculo"}),a.jsxs("select",{id:"tipoVeiculo",className:`form-select ${r.tipoVeiculo?"is-invalid":""}`,value:o.tipoVeiculo,onChange:e=>l({...o,tipoVeiculo:parseInt(e.target.value)}),children:[a.jsx("option",{value:0,children:"Selecione"}),N(p)]}),r.tipoVeiculo&&a.jsx("div",{className:"invalid-feedback",children:r.tipoVeiculo})]}),a.jsxs("div",{className:"col-3",children:[a.jsx("label",{htmlFor:"modelo",className:"form-label",children:"Modelo"}),a.jsx("input",{id:"modelo",type:"text",className:`form-control ${r.modelo?"is-invalid":""}`,value:o.modelo,onChange:e=>l({...o,modelo:e.target.value})})]}),a.jsxs("div",{className:"col-3",children:[a.jsx("label",{htmlFor:"marca",className:"form-label",children:"Marca"}),a.jsx("input",{id:"marca",type:"text",className:`form-control ${r.marca?"is-invalid":""}`,value:o.marca,onChange:e=>l({...o,marca:e.target.value})})]}),a.jsxs("div",{className:"col-3",children:[a.jsx("label",{htmlFor:"placa",className:"form-label",children:"Placa"}),a.jsx(g,{mask:"aaa-9999",id:"placa",type:"text",className:`form-control ${r.placa?"is-invalid":""}`,value:o.placa,onChange:e=>l({...o,placa:e.target.value})})]})]}),a.jsx("div",{className:"row",children:a.jsxs("div",{className:"col-4",children:[a.jsx("label",{htmlFor:"Morador",className:"form-label",children:"Morador "}),a.jsxs("select",{id:"Morador",type:"text",disabled:n!==void 0,className:`form-control ${r.morador?"is-invalid":""}`,value:o.idMorador,onChange:e=>l({...o,idMorador:e.target.value}),children:[a.jsx("option",{value:0,children:"Selecione"}),u.map(e=>a.jsx("option",{value:e.id,children:e.nome},e.id))]})]})}),a.jsx("div",{className:"row",children:a.jsxs("div",{className:"col-12",children:[a.jsx("label",{htmlFor:"observacao",className:"form-label",children:"Observa��o"}),a.jsx("input",{id:"observacao",type:"text",className:`form-control ${r.observacao?"is-invalid":""}`,value:o.observacao,onChange:e=>l({...o,observacao:e.target.value})})]})}),a.jsx("button",{type:"submit",className:"btn btn-primary mt-3",children:"Salvar"})]})]})};export{A as default};
